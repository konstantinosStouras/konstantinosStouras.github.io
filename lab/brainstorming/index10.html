<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Group Ideation • Ideation Challenge</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f9fafb;
      color: #111;
    }
    header {
      background: #2563eb;
      color: white;
      padding: 1rem;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 1rem;
      align-items: center;
    }
    header h1 { margin: 0; font-size: 1.25rem; }
    #timer {
      font-size: 1.2rem;
      font-weight: bold;
      background: #1e40af;
      padding: 0.5rem 1rem;
      border-radius: 8px;
    }
    .leader-bar{
      grid-column: 1 / -1;
      background:#1e3a8a;
      margin-top:.5rem;
      padding:.6rem .8rem;
      border-radius:8px;
      display:flex; justify-content: space-between; align-items:center;
      font-size: .95rem; color:white;
    }

    main {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      padding: 1rem;
    }
    section {
      background: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 1rem;
      display: flex;
      flex-direction: column;
    }
    section h2 {
      margin-top: 0;
      font-size: 1rem;
      border-bottom: 1px solid #ddd;
      padding-bottom: 0.25rem;
      margin-bottom: 0.5rem;
    }
    .messages {
      flex: 1;
      border: 1px solid #ddd;
      padding: 0.5rem;
      border-radius: 4px;
      background: #f3f4f6;
      overflow-y: auto;
      margin-bottom: 0.5rem;
    }
    textarea, input[type=text] {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }
    #groupIdeaDesc { min-height: 60px; }
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 0.6rem .85rem;
      border-radius: 6px;
      cursor: pointer;
    }
    button:disabled { background: #9ca3af; cursor: not-allowed; }
    ul { list-style: none; padding: 0; margin:0; }
    li {
      margin: 0.25rem 0;
      padding: 0.4rem 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #f9fafb;
    }
    .two-col{
      display:grid; grid-template-columns: 1fr 1fr; gap:.5rem;
    }
    .pill{
      display:inline-block; padding:.15rem .5rem; border-radius:999px; background:#e0e7ff; color:#1e3a8a; font-size:.75rem; border:1px solid #c7d2fe;
    }
    .final-box{
      background:#eef2ff;
      border:1px solid #c7d2fe;
      border-radius:8px;
      padding:.5rem;
      margin-top:.5rem;
    }
    .final-box input, .final-box textarea{
      width:100%;
      border:1px solid #ccc;
      border-radius:6px;
      padding:.4rem;
      margin-top:.3rem;
    }
    .final-box textarea{ min-height:40px; }
  </style>
</head>
<body>
  <header>
    <h1 id="instructions">Phase: Group Ideation (20 min)</h1>
    <div id="timer">20:00</div>
    <div class="leader-bar">
      <strong>Leader: <span id="leaderName">To be assigned</span></strong>
      <span class="pill">Leader can add & submit final Top-5</span>
    </div>
  </header>

  <main>
    <section>
      <h2>Instruction</h2>
      <div class="messages">
        <p><i>Collaborate to discuss and refine ideas. Review everyone’s top 5 ideas, then the leader adds group ideas. Select your final top 5 and write short final descriptions. Only the leader can submit.</i></p>
      </div>
    </section>

    <!-- Shared ideas -->
    <section>
      <h2>Participants’ Top Ideas (from Individual Phase)</h2>
      <div class="messages">
        <strong>Alice</strong>
        <ul>
          <li><strong>Smart Sleep Mask</strong> – Adaptive light therapy and guided breathing.</li>
          <li><strong>Hydration Coach</strong> – Bottle sensor + habit nudges.</li>
          <li><strong>Stress Beacon</strong> – Wearable that alerts during spikes.</li>
          <li><strong>Micro-Stretch App</strong> – 30-second posture micro-breaks.</li>
          <li><strong>Clean Snack Box</strong> – Curated healthy snack subscription.</li>
        </ul>
        <strong>Ben</strong>
        <ul>
          <li><strong>Breathwork Ring</strong> – Haptic breathing guide.</li>
          <li><strong>Gut Journal</strong> – Track meals & moods.</li>
          <li><strong>Sleep Soundscape</strong> – AI-generated soothing audio.</li>
          <li><strong>Vitamin Buddy</strong> – Smart pill reminder.</li>
          <li><strong>Mindful Commute</strong> – Audio mindfulness prompts.</li>
        </ul>
        <strong>Chen</strong>
        <ul>
          <li><strong>Cool Pillow Pad</strong> – Temperature-regulated insert.</li>
          <li><strong>Standing Scheduler</strong> – Smart sit-stand timer.</li>
          <li><strong>Sugar Radar</strong> – Hidden sugar detector.</li>
          <li><strong>Yoga Microflows</strong> – 3-minute guided sequences.</li>
          <li><strong>Calm Lighting</strong> – Auto-dim smart lamp.</li>
        </ul>
      </div>
    </section>

    <!-- Group ideas -->
    <section style="grid-column: span 2;">
      <h2>Group Ideas</h2>
      <div class="two-col">
        <input type="text" id="groupIdeaTitle" placeholder="Idea title">
        <input type="text" id="groupIdeaSource" placeholder="Source (member name or ‘New’)">
      </div>
      <textarea id="groupIdeaDesc" placeholder="Idea description (short)"></textarea>
      <button id="addGroupIdea">Add Group Idea</button>

      <h3>Group Idea Candidates</h3>
      <ul id="groupIdeasList"></ul>

      <h3>Final Top 5 (idea + short final description)</h3>
      <ul id="groupTop5List"></ul>

      <div style="margin-top:.5rem;">
        <button id="submitGroupTop5" disabled>Submit Final Top 5</button>
      </div>
    </section>

    <section style="grid-column: span 2;">
      <h2>Notes</h2>
      <textarea id="notes" rows="4" placeholder="Group notes or discussion points..."></textarea>
    </section>
  </main>

  <script>
    // Timer (20 min)
    let time = 1200;
    const timerEl = document.getElementById("timer");
    function updateTimer(){
      const m = String(Math.floor(time/60)).padStart(2,'0');
      const s = String(time%60).padStart(2,'0');
      timerEl.textContent=`${m}:${s}`;
      if(time>0) time--; else {clearInterval(t);alert("Time's up! Please finalize your ideas.");}
    }
    const t=setInterval(updateTimer,1000);

    // Leader set automatically
    const leaderNameEl=document.getElementById('leaderName');
    leaderNameEl.textContent="Alice"; // example; load from backend

    const addBtn=document.getElementById("addGroupIdea");
    const submitBtn=document.getElementById("submitGroupTop5");

    const groupIdeas=[], groupTop5=new Set();

    addBtn.onclick=()=>{
      const title=document.getElementById("groupIdeaTitle").value.trim();
      const desc=document.getElementById("groupIdeaDesc").value.trim();
      const src=document.getElementById("groupIdeaSource").value.trim()||"New";
      if(!title||!desc)return alert("Please enter both title and description.");
      const id=groupIdeas.length+1;
      groupIdeas.push({id,title,desc,src});
      renderIdeas();
      document.getElementById("groupIdeaTitle").value="";
      document.getElementById("groupIdeaDesc").value="";
      document.getElementById("groupIdeaSource").value="";
    };

    function renderIdeas(){
      const ul=document.getElementById("groupIdeasList");
      ul.innerHTML="";
      groupIdeas.forEach(i=>{
        const li=document.createElement("li");
        li.innerHTML=`
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <div><strong>${i.title}</strong> <span class="pill">${i.src}</span><br>${i.desc}</div>
            <label><input type="checkbox" onchange="toggleTop5(${i.id})" ${groupTop5.has(i.id)?"checked":""}> Final Top-5</label>
          </div>`;
        ul.appendChild(li);
      });
      renderTop5();
    }

    window.toggleTop5=id=>{
      if(groupTop5.has(id)) groupTop5.delete(id);
      else{
        if(groupTop5.size>=5)return alert("You can only select 5 ideas.");
        groupTop5.add(id);
      }
      renderTop5();
      submitBtn.disabled=groupTop5.size!==5;
    };

    function renderTop5(){
      const ul=document.getElementById("groupTop5List");
      ul.innerHTML="";
      [...groupTop5].forEach(id=>{
        const idea=groupIdeas.find(i=>i.id===id);
        if(idea){
          const li=document.createElement("li");
          li.innerHTML=`
            <strong>${idea.title}</strong> <span class="pill">${idea.src}</span><br>${idea.desc}
            <div class="final-box">
              <label><strong>Final Idea Title:</strong></label>
              <input type="text" value="${idea.title}">
              <label><strong>Short Final Description:</strong></label>
              <textarea placeholder="Write the short final description..."></textarea>
            </div>`;
          ul.appendChild(li);
        }
      });
    }

    submitBtn.onclick=()=>{
      if(groupTop5.size!==5)return alert("Please select exactly 5 ideas.");
      const results=[...document.querySelectorAll('#groupTop5List li')].map(li=>({
        title:li.querySelector('input').value.trim(),
        desc:li.querySelector('textarea').value.trim()
      }));
      console.log("Submitted Final Top-5:",results);
      alert("Final Top-5 submitted! (Connect to backend)");
    };
  </script>
</body>
</html>
